---
title: "QuickDraw Time"
output: html_notebook
---

```{r}
library(tidyverse)
```

```{r}
filename <- 'dog.stats.csv'
dogs <- read_csv(filename)
```

```{r}
dogs <- dogs %>% mutate(drawing_time_seconds = drawing_time / 1000, drawing_time_draw_seconds = drawing_time_draw / 1000, drawing_time_pause_seconds = drawing_time_pause / 1000)
```

```{r}
#function 
```


```{r}
#dog_drawings <- dogs %>% group_by(key_id) %>% filter(row_number(key_id) == 1)

```

```{r}
#dog_drawings <- dog_drawings %>% select(key_id, recognized, stroke_count, drawing_time, drawing_time_seconds, word, countrycode)
```



```{r}
dogs %>% filter(recognized == 'True') %>% 
  ggplot(aes(x = drawing_time_draw_seconds)) +
  geom_histogram(binwidth = 1) + 
  labs(title = "Histogram of Dog Drawing Time")
```

```{r}
dogs %>% 
  ggplot(aes(x = drawing_time_draw_seconds, fill = recognized)) +
  geom_histogram(binwidth = 1) + 
  labs(title = "Histogram of Dog Drawing Time")
```


```{r}
filename <- 'cat.stats.csv'
cats <- read_csv(filename)

#cats <- cats %>% mutate(drawing_time_seconds = drawing_time / 1000)
cats <- cats %>% mutate(drawing_time_seconds = drawing_time / 1000, drawing_time_draw_seconds = drawing_time_draw / 1000, drawing_time_pause_seconds = drawing_time_pause / 1000)
#cat_drawings <- cats %>% group_by(key_id) %>% filter(row_number(key_id) == 1)
#cat_drawings <- cat_drawings %>% select(key_id, recognized, stroke_count, drawing_time, drawing_time_seconds, word, countrycode)

```


```{r}
cats %>% filter(recognized == 'True') %>% 
  ggplot(aes(x = drawing_time_draw_seconds)) +
  geom_histogram(binwidth = 1) + 
  labs(title = "Histogram of Cat Drawing Time")
```

```{r}
dogs_cats <- rbind(dogs, cats)
```

```{r}
dogs_cats_rec_sum <- dogs_cats %>% group_by(word, recognized) %>% summarise(count = n()) %>% mutate(freq = count / sum(count))
```


```{r}
dogs_cats_rec_sum %>%
  ggplot(aes(x = word, y = freq, fill = recognized)) +
  geom_bar(stat = "identity")
```



```{r}
cats_rec <- cats %>% filter(recognized == 'True')
dogs_rec <- dogs %>% filter(recognized == 'True')


```

```{r}
#dogs_cats <- rbind(cat_drawings_rec, dog_drawings_rec)
```


```{r}
  ggplot() +
  geom_histogram(data = cats_rec, aes(x = drawing_time_seconds, y = (..count..)/sum(..count..)), alpha = 0.6, fill = 'red', binwidth = 1) +
  geom_histogram(data = dogs_rec, aes(x = drawing_time_seconds, y = (..count..)/sum(..count..)), alpha = 0.6, fill = 'blue', binwidth = 1) +
  scale_x_continuous(limits = c(0, 30)) + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = "Distribution of Total Seconds Taken for Drawing a cat vs a dog", y = "", x = "Drawing Time (sec)")
  
```

```{r}
  ggplot() +
  geom_histogram(data = cats_rec, aes(x = drawing_time_draw / 1000, y = (..count..)/sum(..count..)), alpha = 0.6, fill = 'red', binwidth = 1) +
  geom_histogram(data = dogs_rec, aes(x = drawing_time_draw / 1000, y = (..count..)/sum(..count..)), alpha = 0.6, fill = 'blue', binwidth = 1) +
  scale_x_continuous(limits = c(0, 30)) + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = "Distribution of Drawing Seconds Taken for Drawing a cat vs a dog", y = "", x = "Drawing Time (sec)")
```



```{r}
  ggplot() +
  geom_histogram(data = cats_rec, aes(x = drawing_time_pause / 1000, y = (..count..)/sum(..count..)), alpha = 0.6, fill = 'red', binwidth = 1) +
  geom_histogram(data = dogs_rec, aes(x = drawing_time_pause / 1000, y = (..count..)/sum(..count..)), alpha = 0.6, fill = 'blue', binwidth = 1) +
  scale_x_continuous(limits = c(0, 30)) + 
  scale_y_continuous(labels = scales::percent) +
  labs(title = "Distribution of Pause Seconds Taken for Drawing a cat vs a dog", y = "", x = "Drawing Time (sec)")
```



```{r}
mean(cat_drawings_rec$drawing_time_seconds)
mean(dog_drawings_rec$drawing_time_seconds)
```


```{r}
mean(cats_rec$drawing_time_draw_seconds)
mean(dogs_rec$drawing_time_draw_seconds)
```


```{r}
mean(cats_rec$stroke_count)
mean(dogs_rec$stroke_count)
```

```{r}
dogs_rec %>%
  ggplot(aes(x = drawing_time_draw_seconds, y = stroke_count)) +
  geom_point(alpha = 1 / 10)
  
```

```{r}
cats_rec %>%
  ggplot(aes(x = drawing_time_draw_seconds, y = stroke_count)) +
  geom_point(alpha = 1 / 10)
  
```

```{r}
cats_rec %>% filter(drawing_time_draw_seconds < 0) %>% mutate(k = as.character(key_id))
```



```{r}
countrycodes <- dog_drawings %>% group_by(countrycode) %>% summarise(count = n()) %>% arrange(-count)
```



